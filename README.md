# 智能排课系统 (Smart Schedule System)

一个基于 Python (Flask) 和 Google OR-Tools 开发的智能排课系统，专为中小学设计。支持自动化排课、可视化手动微调、高级约束配置及排课数据统计。

## ✨ 核心功能

*   **🚀 智能自动排课**
    *   基于 OR-Tools 约束编程算法。
    *   自动处理课程冲突、老师时间冲突。
    *   支持自定义每日/每周课时容量（默认 9 节/天，45 节/周）。

*   **🖱️ 交互式微调 (Drag & Drop)**
    *   直观的拖拽操作，轻松移动课程。
    *   实时冲突检测，确保调课后课表依然有效。

*   **⚙️ 高级约束管理**
    *   **禁排设置**：可视化网格，点击即可设置老师在特定时段（如周五下午）不排课。
    *   **参数配置**：灵活调整班级数、科目及课时安排。

*   **📊 统计分析看板**
    *   内置 Chart.js 图表。
    *   一键查看所有老师的一周工作量对比。

*   **🔄 智能代课与请假**
    *   处理老师请假请求。
    *   自动推荐合适的代课老师（优先同科目、空闲老师）。
    *   支持课程互换或标记为自习。

*   **📥 数据导入导出**
    *   支持导出单个班级或全校总课表为 Excel 格式。
    *   支持保存和加载多个排课方案。

## 🛠️ 技术栈

*   **后端**: Python 3, Flask
*   **算法**: Google OR-Tools (CP-SAT Solver)
*   **前端**: HTML5, Bootstrap 5, JavaScript (原生), Chart.js
*   **数据处理**: Pandas

## 🚀 快速开始

### 1. 环境要去
*   Python 3.8 或更高版本

### 2. 安装依赖

```bash
pip install -r requirements.txt
```

*如果项目中尚未生成 requirements.txt，主要依赖如下：*
```
flask
flask-cors
ortools
pandas
openpyxl
```

### 3. 运行应用

```bash
python app.py
```

启动后，打开浏览器访问：`http://127.0.0.1:5000`

## 📖 使用指南

1.  **初始化设置**: 点击侧边栏的 **📝** (基本参数设置) 图标，配置班级数量和科目信息。
2.  **高级约束**: 点击 **⚙️** (高级约束设置) 图标，设置老师的禁排时间。
3.  **生成课表**: 点击 "🚀 生成/重置" 按钮开始自动排课。
4.  **查看统计**: 生成成功后，点击 "📊 查看统计看板" 分析工作量。
5.  **手动调整**: 在右侧课表视图中，直接拖动课程单元格进行调整。
6.  **导出结果**: 点击 "📥 导出 Excel" 保存课表文件。

## 📝 目录结构

*   `app.py`: Flask 应用入口及 API 定义。
*   `normal.py`: 核心排课算法实现 (OR-Tools)。
*   `substitution.py`: 代课与调课逻辑处理。
*   `storage.py`: 方案保存与加载的文件存储管理。
*   `export_excel.py`: Excel 导出功能。
*   `templates/index.html`: 前端单页应用 (SPA)。

---
*Created by Antigravity*
